<script>
SPORTCRM.buildSquadHTML = function(data){
    return $.map(data.idClub, function(club, i) {
        var gr = $.map(data.idSquad, function(sq, i) {
            if (sq.club==club.id) return '<option value="'+ sq.id +'">'+ sq.squad_name +' ('+ sq.ssport_name +')</option>';
        }).join('');
        return (gr!='')? '<optgroup label="'+ club.name +'">'+ gr +'</optgroup>':'';
    }).join('');
}
function get_squadData(callback){
    if (window.squadData) {
        callback(squadData);
    } else {
        pJSON(dbvaluesUrl, {mode:'idClub,idSquad', city: 'my'}, function(data){
            window.squadData = SPORTCRM.buildSquadHTML(data);
            callback(squadData, data);
        });
    }
}
</script>